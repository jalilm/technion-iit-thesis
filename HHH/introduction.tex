\section{Introduction}
The increasing popularity of cloud based systems and the shift towards Infrastructure as a Service (IaaS)  as the preferred  solution for many organizations~\cite{Goyal2013}, requires new approaches and novel solutions in the area of system  management. Efficient management of such infrastructure heavily rely  on  efficient monitoring of the system resources and the workload. Despite many previous works considering efficiency aspects of many network management systems~\cite{devoflow, microte, anomaly}, very few tackled the practicality of deploying efficient monitoring tasks.

A practical efficient algorithm for any network monitoring task requires: (1) to be deployable on off the shelf network nodes, (2) to cope with current line rates, and finally (3) to use a limited amount of network resources which is much smaller than the ever increasing number of active flows.

An important monitoring task that was in the spotlight of recent research~\cite{ben2016heavy, basat2017optimal, ben2017constant, sivaraman2017heavy, HHHOnline, tong2015high} is the detection of Heavy Hitters (HH) and Hierarchical Heavy Hitters (HHH). A Heavy Hitter is a flow that is responsible for a considerable portion of the  overall traffic (i.e., flows with traffic that exceeds a certain threshold) and a Hierarchical Heavy Hitter is an aggregation of non-HH flows that share a common property and is responsible, as a whole, for traffic above the threshold.

This paper takes advantage of the ability to reconfigure counters over time in network nodes. These reconfigurations, take place at statically provisioned periods of times, called rounds, depending on the given monitoring interval.
During the rounds, the allocated counters simply measure the traffic of the assigned aggregated prefix. Thus, the per-packet operation can be handled in line rate with no additional support of special data structures or specialized hardware. Furthermore, we exploit the fact that these counters can measure both the number of packets and the total byte count with no additional cost in order to also solve the weighted version of the problem.

We present four algorithms, following the steps of~\cite{conf/sigcomm/YuanCM07,Moraney2016, Moraney2018}.  In the first algorithm we assign to each counter an aggregated set of flows starting from some level of the hierarchy. At the end of each round, the algorithm seeks to zoom in on interesting flows down the hierarchy,  thus evaluates the counters' values and reassigns the counters to the top half of the counters for the new round. The second algorithm aims at improving the performance by increasing the length of each round and decreasing the number of rounds. The motivation is that longer rounds leads to more stable HH and the zooming on process is more accurate.

Our third algorithm remedies a major limitation of the first two algorithms, the lack of ``reconsidering" mechanism. I.e., the ability of the algorithm's to back off from the zooming process if the found flows turned out to be uninteresting and allocate the counter to previously discarded flow. This is achieved by keeping the frontier of the hierarchy disjointly monitored by counters over different levels.
The fourth algorithm, waives the request of disjointly monitoring the frontier by monitored the highest shared ancestor that does not surpass the threshold. The motivation is to reduce the number of counters needed to cover the frontier and to enable deploying the algorithm when less counters are available.


The result is a family of practical efficient monitoring algorithms to the HHH problem which are deployable on off the shelf network nodes (see~\cite{Moraney2016} for practicality of the approach) and can operate in line speed due to its constant time per-packet update operation. Furthermore, the algorithms use a configurable constant number of counters and guarantee not to use more than the allocated counters.

We evaluate the expected performance of our algorithms on real network traffic through an extensive simulation study using CAIDAâ€™s traces~\cite{CAIDA2016, CAIDA2018}.
The results indicate that our algorithms can detect around 90\% of the true HHH while reporting only 3\% non-HHH flows. These results can be achieved in line rate, while not requiring any convergence interval. Also, these results are comparable to the state of the art algorithms: (1)``MST"~\cite{SpaceSaving} - an accurate Space Saving~\cite{Metwally2005} based algorithm that can not be deployed in line rate due to non-constant per-packet update operation, and (2)``RHHH"~\cite{ben2017constant} a probabilistic constant update time improvement of ``MST" that requires a large convergence interval of 100M packets.
